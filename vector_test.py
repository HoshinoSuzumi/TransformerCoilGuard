import matplotlib.pyplot as plt
from numpy import *
from numpy.fft import *


def fft_ma_calculate(s, fs, n1, f1):
    S1 = fft(s, n1)
    A = angle(S1[int(f1 * n1 / fs + 1)])
    M = abs(S1[int(f1 * n1 / fs + 1)]) * 2 / n1
    return M, A


# x = linspace(0, 1, 15000)
# signal_v = 4 * sin(2 * pi * 50 * x)
# signal_i = 0.005 * sin(2 * pi * 50 * (x + random.normal(0, 0.5, 15000)))
signal_v = [-5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -4.967393467609611, -4.525463118566506, -4.029217307629835,
            -3.5601292276399477, -3.044132339651071, -2.5454176440828746, -1.7899389468360027, -1.2319710201111889,
            -0.6937541704385808, -0.17035062855512706, 0.35305291332832667, 1.041871725524004, 3.2934945094754653,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            4.493372440396968, 2.9527884303249152, 1.4541754589888, 0.2987374514347607, -1.4393573291593498,
            -3.3552118032233125, -4.816791505086542, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -4.601998542143804, -3.693448997742337,
            -2.2343381805106333, -1.2591287510579718, -0.5135255923372029, 0.4764971449046129, 1.2764157655189479,
            2.2935962337075466, 3.1009215082164587, 4.648912172183088, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            4.65384994144614, 3.6588894349412726, 2.5108580812818104, 1.382577804674554, 0.21726425859441179,
            -0.7233807860168895, -2.18989825714317, -3.3033652259612722, -4.641500696248215, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -4.908140236452994,
            -3.871208691212189, -3.088572263018534, -1.7627812158892198, -0.6591897855972206, 0.009877949546250875,
            0.6542568383744651, 1.9331390775047907, 3.0663571233750986, 4.157604130509469, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 4.955053866492278, 0.4172439137479955, -1.0492735573782852, -2.056578487040781,
            -3.0243812625988653, -4.204508116468162, -5.021708929503177, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -4.261292462993254, -3.456436073115867, -2.651579683238481, -1.6023037148400476,
            -0.7505385169636725, 1.0764361103653641, 2.676273351594034, 4.698289864813603, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 4.45140140166103, 3.9033090134623194,
            3.323121125053774, 2.7454021212767543, 2.0713966168702314, 1.239382496046062, 0.6369746459537851,
            0.03703568049303385, -0.5332766693894087, -1.3677596748451037, -2.0343585253570495, -2.649110798606955,
            -3.1947343021741403, -3.9033041914220235, -4.411894425516323, -4.915546890347571, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -4.964924582978085,
            -3.7057934208999654, -2.696019606605944, -1.4615772908430813, 0.4147750291164698, 4.379803747346784,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 3.908246782725371, 2.560235773912325, 1.7405660762457842,
            0.8715186859487289, -0.09381520497782958, -1.014709172536925, -1.7948767160990542, -2.3479068735608166,
            -2.8342771459713845, -3.357680687854838, -4.382267809938014, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.04886666044996, -4.394612233095643, -3.693448997742337, -3.1280744171229458,
            -2.3330935657716623, -1.617117022629202, -1.0640868651674396, -0.4789612074958427, 0.14813548891169148,
            0.8665809166856775, 1.6985950375098469, 2.3281606185489068, 2.8861285452737206, 3.528038549470409,
            4.125508630299635, 4.720509826497334, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.024182636174999,
            3.9921888601972455, 3.2663367785286823, 2.226936348656352, 0.8492987242649974, -0.19257059023885859,
            -1.0122402879053993, -1.8269722163088886, -2.8169949535507044, -4.02674842299831, -4.784696004876707,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -4.861231428454005, -4.305732386360717, -3.8218309985816745, -3.3379296108026324,
            -2.829339376708333, -2.3207491426140336, -1.6492125228390364, -1.1184023270610055, -0.5678410542307688,
            -0.04443751234731508, 0.4913104526937673, 1.2245691882569076, 1.7356283069827327, 2.2664385027607636,
            2.7799665061181145, 3.288556740212414, 3.772458127991456, 4.258828400402024, 4.7106342879712315,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 4.730385365023437, 3.6786405119934784, 1.9899234240298824, 0.4764971449046129,
            -0.6888164011755293, -1.8640054857817745, -2.8515593383920645, -3.7378889211098, -4.584716349723124,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -4.1995703472051105, -3.0416634550195454, -1.2517220971633947, 0.29379968217170926,
            2.5034514273872333, 3.6860471658880556, 4.668663249235294, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 4.500779094291545,
            3.414469856420226, 2.1405253865529517, 1.1184071491013015, -0.4567412458121112, -1.7899389468360027,
            -2.9799413392314023, -4.290919078571562, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -4.3328901173075, -1.5134238681051215, 2.656522274541828, 4.614347787341728,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            4.2612972850335495, 2.6466467360157253, 1.2245691882569076, -0.3135459371836191, -2.110893948934347,
            -5.001957852450971, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -4.74272496614077,
            -3.6613534975325024, -2.244213719036736, -0.8418872483301243, 0.38021064427510964, 1.5553997288813548,
            2.604675697279788, 3.6885160505195813, 4.503247978923071, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 4.4859657865023905, 3.5774162421009237, 2.335567272443484, 1.3702333815169254,
            0.4369949908002013, -0.619687631492809, -1.4936727910529157, -2.5577620672405033, -3.5255648427985875,
            -4.293387963203088, -4.994551198556394, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -4.290919078571562, -3.313240764487375, -2.199773795669273,
            -1.2986309051623834, -0.05184416624189225, 0.9184274939477177, 1.8096948459285045, 2.937975122535761,
            3.950217821461308, 4.8809873275465065, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805, 5.02912040543805,
            5.02912040543805, 5.02912040543805, 4.732854249654963, 3.9403422829352053, 3.01944831537611,
            2.0442388859234484, 1.1554404185741873, 0.2765174897510292, -0.5703099388622945, -1.3578841363190008,
            -2.1084250643028213, -2.955252492916145, -3.863802037317612, -4.767413812456027, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794,
            -5.080962160659794, -5.080962160659794, -5.080962160659794, -5.080962160659794]
signal_i = [-1.3504774824244237, -1.3801040980027324, -1.3998551750549382, -1.409730713581041, -1.4171373674756182,
            -1.4171373674756182, -1.4121995982125668, -1.402324059686464, -1.3875107518973095, -1.3677596748451037,
            -1.3455397131613722, -1.3183819822145892, -1.2862864820047548, -1.249253212531869, -1.2097510584274573,
            -1.1653111350599943, -1.113464557797954, -1.0196469417999765, -0.9505181721172562, -0.871513863908433,
            -0.7974473249626612, -0.7258496706484152, -0.6172187468612833, -0.5159944769687286, -0.4419279380229568,
            -0.3604547451826079, -0.2814504369737847, -0.19257059023885859, -0.11356628203003538, -0.027155319926635002,
            0.05431787291371393, 0.13825995038558858, 0.2197331432259375, 0.3382396055391723, 0.42218168301104697,
            0.5011859912198702, 0.5801902994286934, 0.6517879537429394, 0.745605569740917, 1.024589533103324,
            1.2616024577297935, 1.382577804674554, 1.4023288817267598, 1.1258138029958786, 0.7653566467931228,
            0.4073683752218926, 0.1111022194388056, -0.14813066687139553, -0.38761247612939087, -0.5554966310731402,
            -0.7925095556996098, -1.0270535956945537, -1.1875310967437258, -1.3060375590569606, -1.3875107518973095,
            -1.4171373674756182, -1.3628219055820523, -1.2714731742156005, -1.1332156348501599, -0.9529870567487819,
            -0.745600747700621, -0.5727788234938203, -0.4197079763392253, -0.2641682445531046, -0.12344182055613828,
            0.0320979112299824, 0.27157972048797774, 0.42218168301104697, 0.5283437221666532, 0.6690701461636195,
            0.7752321853192257, 0.9060830707900891, 1.0023695714195924, 1.1727226109948674, 1.2616024577297935,
            1.328262342780988, 1.3727022661484511, 1.4072666509898113, 1.41961107414744, 1.409735535621337,
            1.3801089200430283, 1.3455445352016682, 1.293697957939628, 1.2344447267830105, 1.1603781878372388,
            1.0813738796284156, 0.9924940328934895, 0.8789253398433061, 0.762887762161597, 0.6443812998483622,
            0.5159992990090245, 0.42218168301104697, 0.3283640670130694, 0.23454645101509186, 0.1407288350171143,
            -0.03209308918968645, -0.21972832118564156, -0.39501913002396805, -0.5653721695992431, -0.6986919397016322,
            -0.8887960563291131, -1.0221158264315022, -1.16778001969152, -1.249253212531869, -1.2986309051623834,
            -1.3430708285298465, -1.3850418672657838, -1.402324059686464, -1.4146684828440925, -1.409730713581041,
            -1.3949174057918867, -1.2739420588471262, -1.1529667119023657, -1.086306826851171, -1.0122402879053993,
            -0.925829325801999, -0.8344805944355471, -0.7159741321223123, -0.6122809775982319, -0.5258700154948315,
            -0.44439682265448255, -0.3530480912880307, -0.2740437830792075, -0.18269505171275569, 2.411020147974341e-06,
            0.1308532964910114, 0.34070849017069804, 0.5061237604829216, 0.6024102611124249, 0.6937589924788767,
            0.8591742627911003, 0.9974318021565409, 1.1184071491013015, 1.2146936497308047, 1.293697957939628,
            1.365295612253874, 1.392453343200657, 1.4146733048843885, 1.4171421895159142, 1.3949222278321827,
            1.3603578429908225, 1.2961668425711537, 1.13075157225893, 0.9678051865782322, 0.7949832623714315,
            0.5875969533232706, 0.3579906825913781, 0.19257541227915453, -0.5382144386524601, -0.7431318630690953,
            -0.871513863908433, -0.9900203262216678, -1.123340096324057, -1.2072821737959316, -1.2739420588471262,
            -1.3406019438983208, -1.3726974441081552, -1.4121995982125668, -1.4072618289495153, -1.3504774824244237,
            -1.2270332508481374, -1.0443357881152338, -0.8641072100138558, -0.7135052474907866, -0.548089977178563,
            -0.4024257839185452, -0.2320727443432702, -0.06912635866257233, 0.071600065334394, 0.20245095080525743,
            0.3653973364859553, 0.4962482219568187, 0.7480744543724427, 0.9505229941575521, 1.1776603802579189,
            1.2616024577297935, 1.3406067659386167, 1.3899844585691312, 1.409735535621337, 1.4171421895159142,
            1.4146733048843885, 1.3998599970952341, 1.3776400354115026, 1.3455445352016682, 1.3085112657287823,
            1.266540226992845, 1.2048181112047018, 1.1381582261535073, 1.0517472640501069, 0.9801496097358608,
            0.8517676088965231, 0.7604188775300713, 0.6542568383744651, 0.5258748375351274, 0.42958833690562415,
            0.33083295164459514, 0.23207756638356614, 0.10369556554422843, 0.004940180283199425, -0.09134632034630386,
            -0.1851639363442814, -0.2913259754998876, -0.4197079763392253, -0.5036500538111, -0.5925299005460261,
            -0.674003093386375, -0.7826340171735069, -0.8690449792769073, -0.943111518222679, -1.0097714032738736,
            -1.0887757114826968, -1.1455600580077885, -1.1974066352698287, -1.2443154432688175, -1.2862864820047548,
            -1.3331952900037436, -1.3677596748451037, -1.3899796365288353, -1.4047929443179896, -1.4171373674756182,
            -1.4146684828440925, -1.4047929443179896, -1.382572982634258, -1.3307264053722179, -1.2887553666362805,
            -1.239377674005766, -1.1628422504284686, -1.1060579039033769, -0.997426980116245, -0.8838582870660616,
            -0.7900406710680841, -0.6493142470711177, -0.35798586055108217, -0.19257059023885859, 0.029629026598456676,
            0.19504429691068026, 0.39008618280121254, 0.6567257230059909, 1.1455648800480844, 1.2739468808874221,
            1.3727022661484511, 1.4122044202528627, 1.4171421895159142, 1.4122044202528627, 1.355420073727771,
            1.3011046118342051, 1.2541958038352163, 1.1924736880470732, 1.1381582261535073, 1.0764361103653641,
            1.0122451099456953, 0.9184274939477177, 0.8196721086866887, 0.7406678004778655, 0.6591946076375166,
            0.5505636838503847, 0.4444016446947785, 0.3481151440652752, 0.22220202785746324, 0.0123468341777766,
            -0.2123216672910644, -0.3407036681304021, -0.476492322864317, -0.6098120929667061, -0.7357252091745181,
            -0.8394183636985986, -0.9085471333813189, -0.9678003645379363, -1.0270535956945537, -1.140622288744737,
            -1.2319710201111889, -1.2986309051623834, -1.3776352133712066, -1.409730713581041, -1.4171373674756182,
            -1.4072618289495153, -1.3801040980027324, -1.3504774824244237, -1.3183819822145892, -1.283817597373229,
            -1.2443154432688175, -1.1850622121122, -1.1307467502186341, -1.0196469417999765, -0.9406426335911533,
            -0.8517627868562272, -0.7801651325419812, -0.7085674782277351, -0.6270942853873862, -0.5431522079155116,
            -0.4616790150751626, -0.3802058222348137, -0.29626374476293904, -0.20985278265953866, -0.09134632034630386,
            0.029629026598456676, 0.12344664259643423, 0.25182864343577194, 0.3653973364859553, 0.44933941395782995,
            0.5332814914297046, 0.6221613381646307, 0.7209167234256597, 0.8295476472127916, 0.9060830707900891,
            0.9752118404728094, 1.0492783794185812, 1.1184071491013015, 1.1801292648894446, 1.229506957519959,
            1.2690091116243707, 1.3183868042548852, 1.348013419833194, 1.3727022661484511, 1.392453343200657,
            1.4072666509898113, 1.4171421895159142, 1.4171421895159142, 1.4146733048843885, 1.4023288817267598,
            1.3850466893060798, 1.3628267276223482, 1.338137881307091, 1.3060423810972566, 1.2591335730982678,
            1.1529715339426616, 1.0887805335229928, 1.031996186997901, 0.9554607634206036, 0.8665809166856775,
            0.7949832623714315, 0.6863523385842996, 0.5678458762710648, 0.3579906825913781, 0.20738872006830888,
            0.024691257335405226, -0.09875297424088103, -0.26663712918463034, -0.47402343823279125, -0.6246254007558605,
            -0.7381940938060438, -0.84435613296165, -0.9653314799064106, -1.1035890192718512, -1.1825933274806744,
            -1.2615976356894976, -1.3233197514776407, -1.375166328739681, -1.4047929443179896, -1.4171373674756182,
            -1.4171373674756182, -1.4072618289495153, -1.3875107518973095, -1.3628219055820523, -1.3356641746352693,
            -1.3010997897939092, -1.266535404952549, -1.2196265969535602, -1.1653111350599943, -1.1184023270610055,
            -1.0566802112728624, -0.9998958647477707, -0.9060782487497931, -0.8246050559094442, -0.7480696323321467,
            -0.674003093386375, -0.5900610159145003, -0.5135255923372029, -0.4369901687599054, -0.35798586055108217,
            -0.27651266771073324, -0.1752883978181785, -0.07406412792562378, 0.009877949546250875, 0.08888225775507408,
            0.17529321985847446, 0.2567664126988234, 0.36045956722290384, 0.43946387543172705, 0.520937068272076,
            0.5974724918493735, 0.6715390307951452, 0.7702944160561742, 0.8344854164758431, 0.9036141861585634,
            0.9653363019467065, 1.024589533103324, 1.0789049949968899, 1.1332204568904558, 1.1776603802579189,
            1.2344447267830105, 1.2788846501504736, 1.3233245735179366, 1.3578889583592968, 1.3899844585691312,
            1.4122044202528627, 1.4122044202528627, 1.382577804674554, 1.3011046118342051, 1.194942572678599,
            1.0468094947870554, 0.6937589924788767, 0.3456462594337495, 0.15307325817474293, -0.029624204558160727,
            -0.3036703986575162, -0.5283389001263572, -0.6912852858070551, -0.8492939022247015, -0.970269249169462,
            -1.0739624036935425, -1.1628422504284686, -1.266535404952549, -1.3356641746352693, -1.4072618289495153,
            -1.3973862904234124, -1.3529463670559494, -1.2418465586372918, -1.0023647493792964, -0.8344805944355471,
            -0.5999365544406032, -0.42464574560227675, -0.22713497508021874, -0.05925082013646943, 0.13579106575406286,
            0.41971279837952125, 0.6443812998483622, 0.9307719171053463, 1.069029456470787, 1.1702537263633417,
            1.2862913040450508, 1.3628267276223482, 1.4072666509898113, 1.4171421895159142, 1.382577804674554,
            1.3085112657287823, 1.1998803419416504, 1.0739672257338384, 0.9085519554216148, 0.7357300312148141,
            0.5283437221666532, 0.26417306659340056, 0.1111022194388056, -0.07406412792562378, -0.2814504369737847,
            -0.43452128412837965, -0.6591897855972206, -0.8369494790670728, -0.9826136723270906, -1.1307467502186341,
            -1.2270332508481374, -1.320850866846115, -1.3875107518973095, -1.4121995982125668, -1.4121995982125668,
            -1.3949174057918867, -1.3628219055820523, -1.3183819822145892, -1.2344399047427146, -1.123340096324057,
            -0.9406426335911533, -0.7258496706484152, -0.4616790150751626, -0.26910601381615606, -0.07900189718867523,
            0.3777417596435839, 0.9505229941575521, 1.1653159571002902, 1.338137881307091, 1.4146733048843885,
            1.4072666509898113, 1.3356689966755653, 1.2072869958362276, 1.09618718741757, 0.9554607634206036,
            0.7949832623714315, 0.6122857996385278, 0.4246505676425727, 0.24195310490966904, 0.06913118070286828,
            -0.19997724413343576, -0.422176860970751, -0.6394387085450148, -0.8789205178030102, -1.2048132891644059,
            -1.348008597792898, -1.3998551750549382, -1.4171373674756182, -1.4146684828440925, -1.3949174057918867,
            -1.3430708285298465, -1.2640665203210233, -1.1751866735860972, -1.086306826851171, -0.9406426335911533,
            -0.7332563245429924, -0.5258700154948315, -0.350579206656505, -0.15306843613444698, 0.034566795861508126,
            0.269110835856452, 0.4814349141676644, 0.6542568383744651, 0.8097965701605858, 0.943116340262975,
            1.069029456470787, 1.1554404185741873, 1.2517269192036906, 1.3257934581494624, 1.3875155739376055,
            1.4122044202528627, 1.41961107414744, 1.4047977663582856, 1.3727022661484511, 1.3332001120440395,
            1.239382496046062, 1.0764361103653641, 0.9579296480521293, 0.7851077238453286, 0.6098169150070021,
            0.4271194522740984, 0.2666419512249263, 0.10863333480727988, -0.0469063969788408, -0.24935493676395026,
            -0.39748801465549377, -0.5357455540209344, -0.6838786319124779, -0.799916209594187, -0.9332359796965761,
            -1.0492735573782852, -1.1332156348501599, -1.2048132891644059, -1.2615976356894976, -1.3134442129515378,
            -1.3529463670559494, -1.382572982634258, -1.402324059686464, -1.4121995982125668, -1.4146684828440925,
            -1.4047929443179896, -1.382572982634258, -1.3529463670559494, -1.2813487127417034, -1.1751866735860972,
            -1.086306826851171, -0.9801447876955649, -0.8665760946453815, -0.7233807860168895, -0.5826543620199232,
            -0.49377451528499705, -0.38761247612939087, -0.27651266771073324, -0.07159524329409805, 0.09628891164965125,
            0.2765174897510292, 0.4172439137479955, 0.5974724918493735, 0.7332611465832883, 0.8468298396334717,
            0.9850873789989123, 1.1011249566806214, 1.194942572678599, 1.2616024577297935, 1.3875155739376055,
            1.4146733048843885, 1.4146733048843885, 1.3850466893060798, 1.3406067659386167, 1.2467891499406392,
            1.0616228025762098, 0.6764768000581967, 0.4715593756415615, 0.3184885284869665, 0.15307325817474293,
            0.01728460344082805, -0.13825512834529263, -0.2937948601314133, -0.4271146302338025, -0.5579655157046659,
            -0.6764719780179007, -0.7801651325419812, -0.8789205178030102, -0.9801447876955649, -1.0838379422196454,
            -1.1801244428491486, -1.2887553666362805, -1.392448521160361, -1.4121995982125668, -1.3875107518973095,
            -1.3233197514776407, -1.2640665203210233, -1.1998755199013544, -1.1381534041132113, -1.0492735573782852,
            -0.9406426335911533, -0.84435613296165, -0.7135052474907866, -0.5900610159145003, -0.4271146302338025,
            -0.26910601381615606]

# Fs = 250000
# F1 = 50
# N1 = 15000
Fs = 1500
F1 = 50
N1 = 300
t = (zeros(N1) + range(N1)) / Fs

m_u, a_u = fft_ma_calculate(signal_v, Fs, N1, F1)
m_i, a_i = fft_ma_calculate(signal_i, Fs, N1, F1)

mp_u = m_u * cos(2 * pi * F1 * t + a_u)
mp_i = m_i * cos(2 * pi * F1 * t + a_i)

plt.subplot(221)
plt.title('Sampling U/I')
plt.plot(mp_i)
plt.plot(mp_u)

plt.subplot(222)
plt.title('Lissajous figure')
plt.plot(mp_i, mp_u)

plt.subplot(223)
plt.plot(signal_v)

plt.subplot(224)
plt.plot(signal_i)

plt.show()
